# ü¶æ Jarvis Resilience Ping ‚Äî –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ ¬´–±–æ–∫–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å¬ª –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ Jarvis. –ï—Å–ª–∏ Jarvis –∑–∞–≤–∏—Å–∞–µ—Ç –≤ —Ç—è–∂–µ–ª–æ–π –∑–∞–¥–∞—á–µ, –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–± —ç—Ç–æ–º, —á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–æ—Å—å –æ—â—É—â–µ–Ω–∏–µ ¬´–º—ë—Ä—Ç–≤–æ–≥–æ –±–æ—Ç–∞¬ª.

---

## üõ† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–ª—é—á –≤ Redis (`jarvis:status:busy`).
2. **–ò–Ω–¥–∏–∫–∞—Ü–∏—è**: –°—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å ¬´–ø–µ—á–∞—Ç–∞–µ—Ç...¬ª (`typing action`) –≤ Telegram –∫–∞–∂–¥—ã–µ 5—Å.
3. **Heartbeat**: –ï—Å–ª–∏ Jarvis –∑–∞–Ω—è—Ç –±–æ–ª–µ–µ **30 —Å–µ–∫—É–Ω–¥**, –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ: *"–°—ç—Ä, —è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ [–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏]. –ü—Ä–æ–≥—Ä–µ—Å—Å: [N]%. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ. ü¶æ"*
4. **–ü–æ–≤—Ç–æ—Ä**: –ü–æ–≤—Ç–æ—Ä—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥ (—á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å).
5. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ**: –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∫–ª—é—á –≤ Redis –∏—Å—á–µ–∑–∞–µ—Ç, –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∞–µ—Ç: *"‚úÖ –ó–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ó–∞–Ω—è–ª–æ: [–í—Ä–µ–º—è]"*.

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–æ–¥–µ Jarvis

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ç—è–∂–µ–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (–±—ç–∫—Ç–µ—Å—Ç, –ø–∞—Ä—Å–∏–Ω–≥, —Å–±–æ—Ä–∫–∞ –æ—Ç—á–µ—Ç–∞):

```javascript
// 1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å (Redis Hash)
await redis.hSet('jarvis:status:busy', {
    task: '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞',
    progress: '0',
    stage: '–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQLite',
    started: Date.now().toString()
});

// 2. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
await redis.hSet('jarvis:status:busy', 'progress', '45');
await redis.hSet('jarvis:status:busy', 'stage', '–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥');

// 3. –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ ‚Äî —É–¥–∞–ª—è–µ–º –∫–ª—é—á
await redis.del('jarvis:status:busy');
```

---

## üì¶ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–ù–µ–æ–±—Ö–æ–¥–∏–º—ã —Ç–µ –∂–µ –∫–ª—é—á–∏, —á—Ç–æ –∏ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞:
```bash
export TG_BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω"
export TG_CHAT_ID="–∏–¥_—á–∞—Ç–∞"
export REDIS_URL="redis://127.0.0.1:6379" # –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
pm2 start scripts/resilience_ping.js --name jarvis-ping
```

### 3. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
```bash
node scripts/resilience_ping.js &
```

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **0 –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å `https` –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram.
- **–¢–∏—Ö–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –°–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –±–µ–∑ –∑–≤—É–∫–∞ (`disable_notification: true`).
- **–î–≤–æ–π–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ü–æ–Ω–∏–º–∞–µ—Ç –∫–∞–∫ Redis Hash, —Ç–∞–∫ –∏ –ø—Ä–æ—Å—Ç–æ–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, —Ç–æ–ª—å–∫–æ Redis.
